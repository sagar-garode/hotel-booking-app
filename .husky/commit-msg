#!/usr/bin/env sh
. "$(dirname "$0")/husky.sh"

commit_msg_file="$1"
echo "commit msg file path : $1"
if [ -z "$commit_msg_file" ]; then
    echo  "No commit msg file path"
    exit 1
fi

if [ ! -f "$commit_msg_file" ]; then
    echo  "File not found"
    exit 1
fi

commit_msg=$(cat "$commit_msg_file")
regex=/^JIRA-\d{5}: .{10,}/

echo "Commit msg is: $commit_msg"

if echo "$commit_msg" | grep -qE "$regex"; then
    echo "Commit message passed"
    echo 1
else 
    echo "Invalid commit message"
    exit 1
fi